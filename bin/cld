#!/bin/bash
source /var/cld/bin/include/cldfuncs
ARG1=$(echo "${@:1}" | tr ' ' '\n' | grep -v '\--' | head -1)
ARG2=$(echo "${@:1}" | tr ' ' '\n' | grep -v '\--' | head -2 | tail -1)
ARG3=$(echo "${@:1}" | tr ' ' '\n' | grep -v '\--' | head -3 | tail -1)

for OPTS in ${@:1}
do
echo $OPTS | grep -q  '^\--debug' && VERBOSE=" -v"
done

echo "Please select instance to enter"
select VM in $(CLOUDS_USER_ALLOWED | grep -i "$ARG1" | grep -i "$ARG2" | grep -i "$ARG3")
do
  CLD_LOGS
  if [ "$VM" ]
  then
    INSTANCE_GROUP_FUNCS
    echo "You had chosen ${GROUP} $VM"
    $CLD_VARS
    echo
    $CLD_MOUNT &>/dev/null &
    $CLD_TERMINAL
    $CLD_UMOUNT &>/dev/null &
  else
    echo "you choosed incorrect instance, please try again and type numbers only"
  fi
  break
done