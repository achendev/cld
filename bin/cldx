#!/bin/bash
source /var/cld/bin/include/cldfuncs
[ "$SUDO_USER" = "" ] && SUDO_USER=root
#for OPTS in ${@:1}
#do
#echo $OPTS | grep -q '\-\-id=' && VMID=$(echo $OPTS | cut -d '=' -f 2)
#done
#echo ${VMID}
echo $1
#mknod -m 666 /dev/fuse c 10 229 2>&1 >/dev/null
#    echo "Please select VM to enter"
    for VM in $(CLOUDS_USER_ALLOWED | grep "$(cat /var/cld/creds/id_list | awk '{print $2}')" | grep "$1")
do
  CLD_LOGS
  if [ "$VM" = "" ] ; then
   echo "you choosed incorrect VM, please try again and type numbers only"
  elif echo $VM | grep --quiet "STOPPED" ; then
   echo "Sorry, container is not running, probably it's duplicate"
  elif echo $VM | grep --quiet "OFFLINE" ; then
   echo "Sorry, container is OFFLINE, check hypervisor or hosting status"
  elif grep --quiet "$VM" /var/cld/creds/ct_px_hyper_list ; then
    PROXMOX_VARS
    echo
    PROXMOX_TERMINAL
  elif grep --quiet "$VM" /var/cld/creds/ext_*_list ; then
    EXTERNAL_VARS
    echo
    EXTERNAL_TERMINAL
  elif grep --quiet "$VM" /var/cld/creds/ct_virtuozzo_hyper_list ; then
    VIRTUOZZO_VARS
    echo
    VIRTUOZZO_TERMINAL
  elif grep --quiet "$VM" /var/cld/creds/ct_vz_hyper_list ; then
    OPENVZ_VARS
    echo
    OPENVZ_TERMINAL
  fi
  break
done

