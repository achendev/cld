#!/bin/bash
source /var/cld/modules/dns/bin/include/dnsfuncs
CHECKIP=$(echo "$1" | egrep -o "[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\|all")
test $CHECKIP || echoexit1 incorrect ip address

test "$CHECKIP" == "all" && (
echo Instances info:
cat /var/cld/access/groups/*/clouds | cut -d : -f 2- | cut -d _ -f -2 | sed 's#_# - #g'
) | awk '{print "`"$0"`"}'

test "$CHECKIP" != "all" && (
echo Instance info:
grep "$CHECKIP" /var/cld/access/groups/*/clouds | cut -d : -f 2- | cut -d _ -f -2 | sed 's#_# - #g'
echo
echo DNS info:
grep "$CHECKIP" -R --color=always /var/cld/modules/dns/data/cf/`TZ=Europe/Moscow date +%F`/ | cut -d : -f 2-
) | awk '{print "`"$0"`"}'